/*!
 *  Project: Light Zoom Test
 *  Version: 1.0.0 (2013-04-29)
 *  Description: 
 *  Author: Gianluca Giglio - Andrea Verlicchi <gianluca.giglio@gmail.com>
 *  Homepage: http://www.zoomLight.it/
 *  License: 
*/
function pool(o,n,e){var t={};o[n](e);var i=o.data(n);t.pluginName=n,t.api=i,t.target=o,application.stack[n]=t,t=null}function callApi(o,n,e){application.stack[o].api[n](e)}function viewApi(o,n){if(application.stack[o]!==void 0){if(0===Object.keys(application.stack[o].api).length)console.log("Sorry no API found!");else if(console.log(application.stack[o].api),n!==void 0&&n)for(var e in application.stack[o].api)console.log(application.stack[o].api[e])}else console.log("Sorry no PLUGIN found!")}var application={pool:pool,callApi:callApi,viewApi:viewApi,stack:[]};(function(o){function n(n){function e(){console.log("TestPlugin: Init")}function t(){console.log("TestPlugin: Test Public Method")}console.log("TestPlugin: Constructor");var i=this;i.$elem=o(n),e();var l={};return l.testPublicMethod=t,l}o.fn.testPlugin=function(e){return this.each(function(){console.group("%cTestPlugin Plugin started!","font-weight:bold; color: blue;"),o(this).data("testPlugin")||o(this).data("testPlugin",new n(this,e)),console.groupEnd()})}})(jQuery),function(o){function n(n,e){function t(){console.log("ZoomLight: Init"),l(),s()}function i(){console.log("ZoomLight: DetectAgent");var o=!1;return null!==navigator.userAgent.match(/mobile/i)?o=!0:null!==navigator.userAgent.match(/Macintosh/i)?o=!0:o}function l(n){console.log("ZoomLight: OpenLayer");var e=r(n,y.options.openLayer);a(e,"click",function(){y.options.$body.addClass(y.options.zoomOpenClass),o("body, html").scrollTop(0),y.options.isDesktop||g()})}function s(o){console.log("ZoomLight: CloseLayer");var n=r(o,y.options.closeLayer);a(n,"click",function(){y.options.$body.removeClass(y.options.zoomOpenClass),y.options.isDesktop||w()})}function r(o,n){console.groupCollapsed("ZoomLight: Test");var e=void 0===typeof o||"string"!=typeof o&&"object"!=typeof o?n:o;return console.log("promise: ",e),console.groupEnd(),e}function a(n,e,t){if(console.groupCollapsed("ZoomLight: Handler"),console.log("target: ",n),console.log("action:  %c"+e,"font-weight:bold; color: red;"),console.log("fallback:",t),"string"==typeof n)o(n).bind(e,t);else for(var i=0;n.length>i;i++){var l=n[i].replace(/\s+/g,"");if("img"===l.substr(l.length-3,l.length-1))o(n[i]).bind(e,t);else{var s=o(n[i]).data("reference");s!==void 0&&o(n[i]).bind(e,function(){o("#"+s)[e]()})}}console.groupEnd()}function c(n){console.groupCollapsed("ZoomLight: Change Source"),console.log("src: ",n),y.options.$zlImg.fadeOut("slow"),y.options.$preloader.fadeIn("slow");var e=new Image;o(e).load(function(){setTimeout(function(){y.options.$preloader.fadeOut("slow"),y.options.$zlImg.attr("src",n),o(window).resize();var e=h({});u(e),y.options.$zlImg.fadeIn("slow")},2e3)}).error(function(){y.options.$preloader.fadeOut("slow"),y.options.$zlImg.fadeIn("slow"),console.error("error")}).attr("src",n),console.groupEnd()}function g(){console.log("%cZoomLight: DesktopMode","font-weight:bold; color: green;"),p()}function p(){y.options.$zoomLayer.css({overflow:"hidden"}),y.options.$zlImg.css("position","absolute");var n={imgW:y.options.$zlImg.width(),imgH:y.options.$zlImg.height(),wW:o(window).width(),wH:o(window).height(),top:0,left:0,coordinate:{left:0,top:0}};n.top=(n.wH-n.imgH)/2,n.left=(n.wW-n.imgW)/2,n.coordinate.left=n.left,n.coordinate.top=n.top,u(n),setTimeout(function(){n=d(n),m(n),f(n)},500)}function u(o){y.options.$zlImg.css({top:o.top,left:o.left}),console.groupCollapsed("ZoomLight: Image Centered!"),console.log({top:o.top,left:o.left}),console.groupEnd()}function d(o){return console.groupCollapsed("ZoomLight: BindMouse"),console.log(o),y.options.$zoomLayer.bind("mousemove",function(n){return o.coordinate.left=Math.floor(2*o.left*(n.pageX/o.wW)),o.coordinate.top=Math.floor(2*o.top*(n.pageY/o.wH)),o.coordinate}),console.groupEnd(),o}function m(o){console.groupCollapsed("ZoomLight: Animation"),console.log(o),y.options.interval=setInterval(function(){o.wW>o.imgW?o.coordinate.left=o.left:null,o.wH>o.imgH?o.coordinate.top=o.top:null,y.options.$zlImg.css({top:o.coordinate.top,left:o.coordinate.left})},1),console.groupEnd()}function f(n){console.groupCollapsed("ZoomLight: Window resize"),console.log(n),o(window).resize(function(){h(n)}),console.groupEnd()}function h(n){return console.groupCollapsed("ZoomLight: Get Space"),n.imgW=y.options.$zlImg.width(),n.imgH=y.options.$zlImg.height(),n.wW=o(window).width(),n.wH=o(window).height(),n.top=(n.wH-n.imgH)/2,n.left=(n.wW-n.imgW)/2,console.log("info:",n),console.groupEnd(),n}function w(){console.groupCollapsed("ZoomLight: Destroy"),L(),v(),console.groupEnd()}function L(){console.log("ZoomLight: UnbindMouse"),y.options.$zoomLayer.unbind("mousemove")}function v(){console.log("ZoomLight: ClearAnimation"),clearTimeout(y.options.interval)}console.log("ZoomLight: Constructor");var y=this;y.$elem=o(n);var b={isDesktop:i(),zoomOpenClass:"zoomLayerVisible",openLayer:"#mainImage img",closeLayer:"#zoomLayer",$preloader:o("#preloader"),$body:o("body"),$zoomLayer:o("#zoomLayer"),$zlImg:o("#zoomLayer #zoomImage"),$mainImage:o("#mainImage"),$openZoomBtn:o("#mainImage").find("button"),interval:null};y.options=o.extend({},b,e),console.log("ZoomLight: Mobile mode %c"+y.options.isDesktop,"font-weight:bold; color: red;"),t();var z={};return z.openLayer=l,z.closeLayer=s,z.changeSrc=c,z}o.fn.zoomLight=function(e){return this.each(function(){console.group("%cZoomLight Plugin started!","font-weight:bold; color: blue;"),o(this).data("zoomLight")||o(this).data("zoomLight",new n(this,e)),console.groupEnd()})}}(jQuery),$(function(){console.group("Scope Index started!");try{var o={openLayer:["#mainImage img","#mainImage button","#container h1"]};pool($("body"),"zoomLight",o),pool($("#test"),"testPlugin",{})}catch(n){console.error("Scope Index error!"),console.error(n)}console.groupEnd()});